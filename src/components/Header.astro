---
import FacebookLogo from "../assets/icons/FacebookLogo.astro";
import WhatsAppLogo from "../assets/icons/WhatsAppLogo.astro";
import PhoneIcon from "../assets/icons/PhoneIcon.astro";
import PeraltaAsociados from "../assets/icons/PeraltaAsociados.astro";
---

<header class="bg-white">
  <!-- Primera fila - Redes sociales y teléfono -->
  <div class="bg-primary text-white py-4">
    <div class="container mx-auto px-4 flex justify-between items-center">
      <!-- Redes sociales -->
      <div class="items-center gap-4 flex">
        <a
          href="https://www.facebook.com/PeraltaAsociadosPeru/"
          class="hover:text-secondary transition-colors duration-300"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Visita nuestro perfil de Facebook"
        >
          <span class="sr-only">Facebook</span>

          <FacebookLogo />
        </a>

        <a
          href="https://api.whatsapp.com/send?phone=976762237"
          class="hover:text-secondary transition-colors duration-300"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Envíanos un mensaje por WhatsApp"
        >
          <span class="sr-only">WhatsApp</span>

          <WhatsAppLogo />
        </a>
      </div>

      <!-- Teléfono -->
      <div class="flex items-center gap-2">
        <PhoneIcon />
        <a
          href="tel:976762237"
          class="text-sm hover:text-secondary transition-colors duration-300"
          aria-label="Llámanos al +51 976 762 237"
        >
          +51 976 762 237
        </a>
      </div>
    </div>
  </div>

  <!-- Segunda fila - Logo, navegación y correo -->
  <div class="mx-auto px-4 py-4">
    <div class="flex justify-between items-center">
      <!-- Logo -->
      <div class="flex items-center gap-4">
        <div class="text-primary">
          <PeraltaAsociados />
        </div>
        <div>
          <h1 class="font-serif lg:text-2xl text-xl font-bold text-primary">
            Peralta Asociados
          </h1>
          <p class="text-sm text-gray-600 hidden lg:flex">
            Asesoría Legal en Huancavelica
          </p>
        </div>
      </div>

      <!-- Navegación -->
      <nav class="hidden lg:block">
        <ul class="flex gap-8 font-merriweather">
          <li>
            <a
              href="/"
              class="text-primary hover:text-secondary text-sm lg:text-base transition-colors duration-300"
              aria-current="page"
            >
              Inicio
            </a>
          </li>
          <li>
            <a
              href="/servicios"
              class="text-primary text-sm lg:text-base hover:text-secondary transition-colors duration-300"
            >
              Servicios
            </a>
          </li>
          <li>
            <a
              href="/nosotros"
              class="text-primary text-sm lg:text-base hover:text-secondary transition-colors duration-300"
            >
              Nosotros
            </a>
          </li>
          <li>
            <a
              href="/testimonios"
              class="text-primary text-sm lg:text-base hover:text-secondary transition-colors duration-300"
            >
              Testimonios
            </a>
          </li>
          <li>
            <a
              href="/contacto"
              class="text-primary text-sm lg:text-base hover:text-secondary transition-colors duration-300"
            >
              Contacto
            </a>
          </li>
        </ul>
      </nav>

      <!-- Correo -->
      <div class="hidden xl:flex items-center gap-2">
        <a
          href="mailto:cyarupaitanp@gmail.com"
          class="flex items-center gap-2 text-primary hover:text-secondary transition-colors duration-300"
          aria-label="Envíanos un correo electrónico"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
            ></path>
          </svg>
          <span class="text-sm">cyarupaitanp@gmail.com</span>
        </a>
      </div>

      <!-- Botón menú móvil -->
      <button
        class="lg:hidden text-primary hover:text-secondary transition-colors duration-300 cursor-pointer"
        id="mobile-menu-button"
        aria-label="Abrir menú"
        aria-expanded="false"
      >
        <svg
          class="w-8 h-8"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>

      <!-- Menú móvil -->
      <div
        id="mobile-menu"
        class="hidden fixed inset-0 z-50 bg-white/95 backdrop-blur-sm transform transition-all duration-300"
        role="dialog"
        aria-modal="true"
      >
        <div class="container mx-auto px-4 py-8">
          <div class="flex justify-between items-center mb-8">
            <div
              class="text-primary transform transition-all duration-300 hover:scale-105"
            >
              <PeraltaAsociados />
            </div>
            <button
              id="close-menu"
              class="text-primary hover:text-secondary transition-all duration-300 p-2 cursor-pointer"
              aria-label="Cerrar menú"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <nav class="py-4">
            <ul class="flex flex-col gap-8 text-center">
              <li
                class="transform transition-all duration-300 hover:-translate-y-1"
              >
                <a
                  href="/"
                  class="text-primary hover:text-secondary transition-colors duration-300 text-xl block py-2 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-secondary after:transition-all after:duration-300 hover:after:w-full"
                >
                  Inicio
                </a>
              </li>
              <li
                class="transform transition-all duration-300 hover:-translate-y-1"
              >
                <a
                  href="/"
                  class="text-primary hover:text-secondary transition-colors duration-300 text-xl block py-2 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-secondary after:transition-all after:duration-300 hover:after:w-full"
                >
                  Servicios
                </a>
              </li>
              <li
                class="transform transition-all duration-300 hover:-translate-y-1"
              >
                <a
                  href="/"
                  class="text-primary hover:text-secondary transition-colors duration-300 text-xl block py-2 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-secondary after:transition-all after:duration-300 hover:after:w-full"
                >
                  Nosotros
                </a>
              </li>
              <li
                class="transform transition-all duration-300 hover:-translate-y-1"
              >
                <a
                  href="/"
                  class="text-primary hover:text-secondary transition-colors duration-300 text-xl block py-2 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-secondary after:transition-all after:duration-300 hover:after:w-full"
                >
                  Testimonios
                </a>
              </li>
              <li
                class="transform transition-all duration-300 hover:-translate-y-1"
              >
                <a
                  href="/"
                  class="text-primary hover:text-secondary transition-colors duration-300 text-xl block py-2 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-secondary after:transition-all after:duration-300 hover:after:w-full"
                >
                  Contacto
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  const mobileMenuButton = document.querySelector(
    "#mobile-menu-button"
  ) as HTMLButtonElement;
  const closeMenuButton = document.querySelector(
    "#close-menu"
  ) as HTMLButtonElement;
  const mobileMenu = document.querySelector("#mobile-menu") as HTMLDivElement;

  const toggleMenu = () => {
    const isHidden = mobileMenu.classList.contains("hidden");

    if (isHidden) {
      // Primero removemos hidden
      mobileMenu.classList.remove("hidden");

      // Esperamos al siguiente frame para añadir la animación
      requestAnimationFrame(() => {
        mobileMenu.style.transform = "translateX(0)";
        mobileMenu.style.opacity = "1";
      });
    } else {
      // Iniciamos la animación de salida
      mobileMenu.style.transform = "translateX(100%)";
      mobileMenu.style.opacity = "0";

      // Esperamos a que termine la animación
      mobileMenu.addEventListener(
        "transitionend",
        () => {
          mobileMenu.classList.add("hidden");
        },
        { once: true }
      );
    }

    document.body.classList.toggle("overflow-hidden");
    mobileMenuButton.setAttribute("aria-expanded", isHidden.toString());
  };

  const closeOnEscape = (e: KeyboardEvent) => {
    if (e.key === "Escape" && !mobileMenu.classList.contains("hidden")) {
      toggleMenu();
    }
  };

  mobileMenuButton.addEventListener("click", toggleMenu);
  closeMenuButton.addEventListener("click", toggleMenu);
  document.addEventListener("keydown", closeOnEscape);
</script>

<style>
  #mobile-menu {
    transform: translateX(100%);
    opacity: 0;
  }
</style>
